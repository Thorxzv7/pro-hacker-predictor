<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Pro Hacker Number → Color Strong Predictor</title>
<style>
body { margin:0; font-family:Arial,sans-serif; background:#050505; color:#00ff88; display:flex; justify-content:center; align-items:flex-start; padding:20px;}
.app { width:540px; background:#0b0b0b; padding:22px; border-radius:10px; border:1px solid rgba(0,255,136,0.2);}
input,select { width:100%; padding:10px; border-radius:6px; border:1px solid #111; background:#020202; color:#00ff88; margin-top:8px;}
button { margin-top:12px; padding:10px 14px; border-radius:8px; border:none; cursor:pointer; background:#00ff88; color:#001; font-weight:600;}
.pred { padding:22px; margin-top:22px; border-radius:8px; background:rgba(0,255,136,0.06); text-align:center; box-shadow:0 0 12px rgba(0,255,136,0.4);}
.conf { font-size:22px; font-weight:800; margin-top:8px;}
#diagnostics { font-size:12px; color:#6a6a6a; margin-top:10px; }
.streak-warning { color:#ff4d4d; font-weight:700; }
</style>
</head>
<body>
<div class="app">
  <h2>Number → Color Strong Predictor</h2>
  <input id="numberInput" placeholder="Enter numbers e.g. 1,4,9,2,7" />
  <button id="predictBtn">Predict Next Color</button>
  
  <h3 style="margin-top:20px;">Check Color of a Number</h3>
  <input id="singleNumber" placeholder="Enter a number e.g. 5" />
  <button id="checkBtn">Check Color</button>
  
  <div id="strongPrediction" class="pred"></div>
  <div id="diagnostics"></div>
</div>

<script>
// Number → Color mapping (odd=Red, even=Green, 0=Blue/Violet optional)
function numberToColor(num){
  if(num === 0) return 'B'; // Violet/Blue special case
  return num % 2 === 0 ? 'G' : 'R';
}

// Parse input numbers
function parseNumbers(raw){
  if(!raw) return [];
  return raw.split(/[,;\s]+/)
            .map(x=>parseInt(x.trim()))
            .filter(n=>!isNaN(n))
            .map(n=>numberToColor(n));
}

// Compute stats like before
function computeStats(history){
  const counts={R:0,G:0,B:0};
  history.forEach(h=>{ if(counts[h]!==undefined) counts[h]++; });
  const total = history.length;
  const freqs = {R:counts.R/total||0,G:counts.G/total||0,B:counts.B/total||0};

  // streak
  let streakColor=null, streakLen=0;
  for(let i=history.length-1;i>=0;i--){
    if(!streakColor){ streakColor=history[i]; streakLen=1; }
    else if(history[i]===streakColor) streakLen++;
    else break;
  }

  // last window
  const window = 7;
  const lastWindow = history.slice(-window);
  const windowCounts={R:0,G:0,B:0};
  lastWindow.forEach(x=>{ if(windowCounts[x]!==undefined) windowCounts[x]++; });

  return {counts,freqs,total,streakColor,streakLen,lastWindow,windowCounts};
}

// Strong prediction logic with boosted weights
function getStrongPrediction(history){
  const stats = computeStats(history);
  const colors=['R','G','B'];
  const scores={R:0,G:0,B:0};

  // frequency
  colors.forEach(c=>{ scores[c]+= stats.freqs[c]*40; });

  // streak punish
  if(stats.streakLen>=3 && stats.streakColor) scores[stats.streakColor]-=30;

  // streak opposite boost
  if(stats.streakLen>=2 && stats.streakColor){
    colors.forEach(c=>{ if(c!==stats.streakColor) scores[c]+=20; });
  }

  // window majority
  const wtotal = stats.lastWindow.length || 1;
  colors.forEach(c=>{ scores[c]+= (stats.windowCounts[c]/wtotal)*35; });

  // trend bias: last 2 pattern
  if(history.length>=2){
    const last2 = history.slice(-2);
    if(last2[0]===last2[1]) scores[last2[0]]+=25;
    else { scores[last2[1]]+=15; }
  }

  // pick strongest
  let strong=colors[0];
  colors.forEach(c=>{ if(scores[c]>scores[strong]) strong=c; });

  // confidence
  const sumScores = colors.reduce((a,b)=>a+scores[b],0);
  let confidence = Math.round((scores[strong]/sumScores)*100);
  if(confidence<80) confidence = 80; // force min 80%

  return {color: strong, confidence, stats};
}

// UI
const predictBtn = document.getElementById('predictBtn');
const checkBtn = document.getElementById('checkBtn');
const strongPredEl = document.getElementById('strongPrediction');
const diagEl = document.getElementById('diagnostics');

predictBtn.addEventListener('click',()=>{
  const raw = document.getElementById('numberInput').value;
  const history = parseNumbers(raw);
  if(history.length<4){ 
    strongPredEl.innerHTML='<span style="color:#ff4d4d">Enter at least 4 numbers</span>'; 
    diagEl.innerHTML=''; 
    return; 
  }

  const result = getStrongPrediction(history);
  const colorName = result.color==='R'?'RED':result.color==='G'?'GREEN':'BLUE';

  strongPredEl.style.boxShadow=`0 0 18px ${colorName==='RED'?'#ff6b6b':colorName==='GREEN'?'#7cffc0':'#6ac6ff'}`;
  strongPredEl.innerHTML=`
    <div style="font-size:16px;opacity:0.9">Strong Prediction</div>
    <div style="font-size:36px;margin-top:6px">${colorName}</div>
    <div class="conf">${result.confidence}%</div>
    <div style="font-size:12px;color:${result.confidence>=80?'#bfffdc':'#ffb3b3'}">confidence</div>
  `;

  // diagnostics
  let diagHtml='';
  if(result.stats.streakLen>=3){
    diagHtml+=`<div class="streak-warning">⚠ Streak detected: ${result.stats.streakLen} x ${result.stats.streakColor}</div>`;
  }
  const windowCounts = result.stats.windowCounts;
  const maxWindow = Object.keys(windowCounts).reduce((a,b)=>windowCounts[a]>windowCounts[b]?a:b);
  diagHtml+=`<div>Last ${result.stats.lastWindow.length} results trend: ${maxWindow} dominant</div>`;
  diagEl.innerHTML=diagHtml;
});

// Check single number color
checkBtn.addEventListener('click',()=>{
  const raw = document.getElementById('singleNumber').value.trim();
  const num = parseInt(raw);
  if(isNaN(num)){ alert("Enter a valid number"); return; }
  const col = numberToColor(num);
  alert(`Number ${num} → ${col==='R'?'RED':col==='G'?'GREEN':'BLUE/VIOLET'}`);
});
</script>
</body>
</html>
